general:
  artifacts:
    - "test"


#details on running sauselabs tests with circle ci can be found here https://circleci.com/docs/browser-testing-with-sauce-labs/
test:

  # pre:
  #   - npm run eslint

  override:
    # - cd sc-*-linux && ./bin/sc --user $SAUCE_USERNAME --api-key $SAUCE_ACCESS_KEY --readyfile ~/sauce_is_ready:
    #     background: true
    # # Wait for tunnel to be ready
    # - while [ ! -e ~/sauce_is_ready ]; do sleep 1; done
    # - npm start:
    #     background: true
    #
    # # Run performance, nightwatch & unit tests
    # - case $CIRCLE_NODE_INDEX in 0) npm run test:e2eRemote ;; 1) npm run perf-t && npm run test ;; esac:
    #     parallel: true
    - elm-package install --yes
    - npm test

  # post:
  #   - killall --wait sc
  #   - pip install --user codecov
  #   - codecov --file coverage/lcov.info --disable search --token=f054ae63-f930-4ad8-ba09-e2b2be42b2d6

dependencies:
   cache_directories:
    - elm-stuff/build-artifacts
    - node_modules

  post:
    - npm i -g elm
    - elm-package install -y
        # Build the project once so that we can cache the build artifacts inside
    # `elm-stuff/build-artifacts`
    - elm-make src/Main.elm --output /tmp/main.js
    - elm-test
