
machine:
  node:
    version: 6.0.0

general:
  artifacts:
    - "test"

test:
  pre:
    - |
      if [ ! -d $INSTALL_PATH/sysconfcpus/bin ]; then
        git clone https://github.com/obmarg/libsysconfcpus.git
        cd libsysconfcpus
        ./configure --prefix=$INSTALL_PATH/sysconfcpus
        make && make install
        cd ..
      fi

    - npm i -g elm

# using sysconfcpus to speed up elm compiler # See: https://github.com/elm-lang/elm-compiler/issues/1473#issuecomment-245704142
  override:
    - ~/dependencies/sysconfcpus/bin/sysconfcpus -n 2 npm test
